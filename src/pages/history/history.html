<!--
  Generated template for the HistoryPage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<ion-header>

  <ion-navbar>
    <ion-title>ORDER HISTORY</ion-title>
  </ion-navbar>

</ion-header>


<ion-content>
  <form [formGroup]="frmFilter" (ngSubmit)="doFilter()">
    <ion-grid>
      <ion-row>
        <ion-col col-6>
          <ion-item>
            <ion-label stacked>START</ion-label>
            <ion-datetime displayFormat="YYYY-MM-DD" formControlName="onStart"></ion-datetime>
          </ion-item>
        </ion-col>
        <ion-col col-6>
          <ion-item>
            <ion-label stacked>END</ion-label>
            <ion-datetime displayFormat="YYYY-MM-DD" formControlName="onEnd"></ion-datetime>
          </ion-item>
        </ion-col>
      </ion-row>
      <ion-row>
        <ion-col>
          <button ion-button color="dark" full type="submit" [disabled]="!frmFilter.valid">FILTER</button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </form>
  <hr/>
  <ion-card *ngFor="let order of orders; let i=index;">
    <ion-card-header>
      <ion-icon name="ios-cart-outline"></ion-icon> Order No. #{{ order.code }}
      <br/>
      <small><ion-icon name="ios-calendar-outline"></ion-icon> {{ order.created_at | date:'dd MMM yyyy HH:mm' }}</small>
        <button ion-button small icon-only (click)="viewOrder(order.id)">
          <ion-icon name="search"></ion-icon>
        </button>
    </ion-card-header>
    <ion-card-content>
        <ion-grid>
          <ion-row>
            <ion-col col-3>
              <strong>JOB : </strong>
            </ion-col>
            <ion-col col-9>
               {{ order.jobname }}
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col col-6>
                  <strong>PRICE : </strong> {{ order.price }} .-
            </ion-col>
            <ion-col col-6>
                  <strong>STATUS : </strong> <span class="status">{{ order.status }}</span>
            </ion-col>
          </ion-row>
          <ion-row *ngIf="order.status == 'finish'">
            <ion-col col-4><strong>Ratting : </strong></ion-col>
            <ion-col col-8 text-right>
              <button *ngIf="order.rating.rate=='N'" ion-button color="dark" (click)="modalRating(order.id)">Add Rating</button>
              <div *ngIf="order.rating.rate=='Y'">
                  <rating [(ngModel)]="score[i]"
                      readOnly="true"
                      max="5" 
                      emptyStarIconName="star-outline" 
                      starIconName="star" 
                      nullable="false"
                      >
                  </rating>
                <strong>{{ order.rating.score }}</strong>
              </div>
            </ion-col>
          </ion-row>
        </ion-grid>
    </ion-card-content>
  </ion-card>
</ion-content>
